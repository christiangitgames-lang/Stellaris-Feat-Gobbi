#root = starbase
#from = player

# Weights in the ai_design part are multiplied with the base weight of 00_starbase_buildings.txt and 00_starbase_modules.txt
# Then, a random number between that value and and extra 50% of that it is ADDED to it
# F.e. 100 base weight multiplies with 2.00 = 200. Then we take a random number between 0 and 100 (50% of 200) and ADD it to 200. 235 then, for example
# This is done for ALL starbase modules and buildings in the list every time an evaluation is made
# And the building or module with the highest value will be chosen to being built
# The implication of that is that you can not balance the weights TOO FAR from each other - otherwise some modules will never be chosen, unless they are the only thing on the evaluation
# Due to the progression of the game and the unlocking of tech, though, it is often the case that there will only be 1 item on the list at any given time anyway

# How the AI/game selects which type to use:
# First of all, it will try to find one which fulfils both the potential trigger and has a positive weight_modifier
# If this succeeds, the starbase already has a type.
# If it fails, it will go through each starbase type that fulfils the potential trigger. Then it will check the ratio it has built (total of this type / total upgraded starbases) compared to the desired ratio. If it is set to desire a minimum value and owns less than that, it multiplies its ratio desire by * 100. Then it build according to that type's template.

# Shipyard
sfoodsolar = {
	potential = {
		has_starbase_size > starbase_outpost
		owner = {
			is_hive_empire = yes
			OR = {
				is_void_dweller_empire = yes
				has_technology = "tech_food_processing_1"
			}
		}
	}

	weight_modifier = {
		base = 0
		modifier = {
			add = 100
			owner = {
				has_monthly_income = {
					resource = food
					value < 10
				}
			}
		}
	}

	ai_design = {
		min = {
			base = 1
		}

		ratio = {
			base = 0.20
			modifier = {
				add = 0.10
				exists = owner
				owner = {
					has_ethic = ethic_militarist
				}
			}
			modifier = {
				add = 0.05
				exists = owner
				owner = {
					has_ethic = ethic_fanatic_militarist
				}
			}
		}

		# token followed by priority
		buildings = {
			hydroponics_bay = {
				base = 2.00
			}
		}

		modules = {
			solar_food_network = {
				base = 1.00
			}
		}
	}
}

# Energy hub
energy_hub = {
	potential = {
		has_starbase_size > starbase_outpost
		exists = owner
		owner = { has_ethic = ethic_gestalt_consciousness }
		NOT = { has_starbase_module = shipyard }
	}

	weight_modifier = {
		base = 0
		complex_trigger_modifier = { #+100 for each trading_hub
			trigger = count_starbase_modules
			parameters = {
				type = solar_panel_network
			}
			mode = add
			mult = 50
		}
		modifier = {
			add = 1000
			exists = owner
			owner = {
				has_monthly_income = { resource = energy value < 40 }
			}
			
		}
	}

	ai_design = {
		min = {
			base = 0
		}

		ratio = {
			base = 0.25
		}

		# token followed by priority
		buildings = {

			nebula_refinery = {
				base = 1.00
			}

			mining_bay = {
				base = 1.00
			}

			hydroponics_bay = {
				base = 1.00
			}

			resource_silo = {
				base = 0.25
			}

			art_college = {
				base = 1.00
			}

			curator_think_tank = {
				base = 1.00
			}

			ice_mining_station = {
				base = 1.00
			}

			dragon_hatchery = {
				base = 1.00
			}

			hydroponics_bay = {
				base = 1.00
			}
			
			black_hole_signal_transmitter = {
				base = 5.00
			}
			
			allied_black_hole_signal_transmitter = {
				base = 1.00
			}
			
			pulsar_signal_receiver = {
				base = 5.00
			}
			
			allied_pulsar_signal_receiver = {
				base = 1.00
			}

			communications_jammer = {
				base = 0.05
			}

			yuht_detection_array = {
				base = 1.25
				modifier = {
					factor = 0
					exists = owner
					owner = {
						OR = {
							has_megastructure = spy_orb_1
							has_megastructure = spy_orb_2
							has_megastructure = spy_orb_3
							has_megastructure = spy_orb_4
						}
					}
				}
				modifier = {
					factor = 0.10
					exists = owner
					owner = {
						any_owned_starbase = {
							count_starbase_buildings = {
								type = yuht_detection_array
								count > 0
							}
						}
					}
				}
			}
		}

		modules = {
			solar_panel_network = {
				base = 1.0
			}
		}
	}
}